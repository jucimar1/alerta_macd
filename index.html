<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SOL Pro Dashboard</title>
    <!-- Lightweight Charts - Biblioteca de Gráficos Profissionais -->
    <script src="https://unpkg.com"></script>
    <style>
        body { background: #0b0e11; color: #eaecef; margin: 0; font-family: sans-serif; height: 100vh; display: flex; flex-direction: column; }
        #chart { flex-grow: 1; min-height: 400px; width: 100%; }
        .stats { height: 120px; padding: 15px; background: #181a20; display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; border-top: 2px solid #2b3139; }
        .box { background: #2b3139; padding: 10px; border-radius: 4px; text-align: center; }
        .val { color: #f0b90b; font-weight: bold; display: block; font-size: 1.1em; }
    </style>
</head>
<body>
    <div id="chart"></div>
    <div class="stats">
        <div class="box">Preço SOL<span id="price" class="val">---</span></div>
        <div class="box">Suporte 24h<span id="sup" class="val" style="color: #0ecb81;">---</span></div>
        <div class="box">Resistência 24h<span id="res" class="val" style="color: #f6465d;">---</span></div>
    </div>

    <script>
        // 1. Inicializar Gráfico
        const chart = LightweightCharts.createChart(document.getElementById('chart'), {
            layout: { background: { color: '#0b0e11' }, textColor: '#848e9c' },
            grid: { vertLines: { color: '#1f2226' }, horzLines: { color: '#1f2226' } },
            crosshair: { mode: LightweightCharts.CrosshairMode.Normal },
            timeScale: { timeVisible: true, borderVisible: false }
        });

        const candleSeries = chart.addCandlestickSeries({
            upColor: '#0ecb81', downColor: '#f6465d', borderVisible: false,
            wickUpColor: '#0ecb81', wickDownColor: '#f6465d'
        });

        // Variáveis para as linhas horizontais
        let supLine, resLine;

        async function updateDashboard() {
            try {
                const response = await fetch('https://api.binance.com');
                const rawData = await response.json();

                // 2. Corrigir Formato de Dados (ESSENCIAL)
                const formattedData = rawData.map(d => ({
                    time: d[0] / 1000, // Converte timestamp para segundos
                    open: parseFloat(d[1]),
                    high: parseFloat(d[2]),
                    low: parseFloat(d[3]),
                    close: parseFloat(d[4])
                }));

                candleSeries.setData(formattedData);

                // 3. Cálculos de Suporte e Resistência (24h)
                const last24 = formattedData.slice(-24);
                const currentSup = Math.min(...last24.map(c => c.low));
                const currentRes = Math.max(...last24.map(c => c.high));
                const lastPrice = formattedData[formattedData.length - 1].close;

                // Atualizar texto na tela
                document.getElementById('price').innerText = `$${lastPrice.toFixed(2)}`;
                document.getElementById('sup').innerText = `$${currentSup.toFixed(2)}`;
                document.getElementById('res').innerText = `$${currentRes.toFixed(2)}`;

                <div id="dashboard" style="background: #1e222d; padding: 15px; border-radius: 8px; margin: 10px;">
    <h3>Status Sniper SOL</h3>
    <p>Preço Atual: <span id="price">-</span></p>
    <p>Distância Suporte: <span id="dSup">-</span>%</p>
    <p>Tendência MACD: <span id="mTrend">-</span></p>
</div>

<script>
    async function updateDashboard() {
        const res = await fetch('https://api.binance.com');
        const data = await res.json();
        const closes = data.map(d => parseFloat(d[4]));
        const lows = data.map(d => parseFloat(d[3]));
        
        const current = closes[closes.length - 1];
        const support = Math.min(...lows.slice(-24));
        const dist = ((current - support) / support * 100).toFixed(2);

        document.getElementById('price').innerText = `$${current}`;
        document.getElementById('dSup').innerText = dist;
        document.getElementById('dSup').style.color = dist < 1 ? '#00ff88' : '#fff';
    }
    setInterval(updateDashboard, 30000);
    updateDashboard();
</script>


                // 4. Desenhar Linhas no Gráfico
                if (supLine) candleSeries.removePriceLine(supLine);
                if (resLine) candleSeries.removePriceLine(resLine);

                supLine = candleSeries.createPriceLine({
                    price: currentSup, color: '#0ecb81', lineWidth: 2, lineStyle: 2, axisLabelVisible: true, title: 'SUPORTE'
                });
                resLine = candleSeries.createPriceLine({
                    price: currentRes, color: '#f6465d', lineWidth: 2, lineStyle: 2, axisLabelVisible: true, title: 'RESISTÊNCIA'
                });

            } catch (error) {
                console.error("Erro ao carregar dados:", error);
            }
        }

        updateDashboard();
        setInterval(updateDashboard, 60000); // Atualiza a cada minuto
    </script>
</body>
</html>
